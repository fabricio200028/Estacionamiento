<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Gestión de Estacionamiento</title>
    <link rel="stylesheet" href="/styles/index.css">
</head>
<body>
    <header>
        <h1 class="logo">Parking Plus</h1>
    </header>

    <div class="margen_1">

    <!-- Formulario para registrar la entrada de un vehículo -->
    <section>
        <h2>Registrar Entrada de Vehículo</h2>
        <form action="/entrada" method="POST">
            <div>
                <label for="matricula">Matrícula:</label><br/>
                <input class="margen_1" type="text" id="matricula" name="matricula" required>
            </div>
            <div>
                <label for="tipo_vehiculo">Tipo de Vehículo:</label><br/>
                <select class="margen_1" id="tipo_vehiculo" name="tipo_vehiculo" required>
                    <option value="">Seleccionar</option>
                    <% if (typeof tarifas !== 'undefined' && tarifas.length > 0) { %>
                        <% tarifas.forEach(function(tarifa) { %>
                            <option value="<%= tarifa.tipo_vehiculo %>"><%= tarifa.tipo_vehiculo %></option>
                        <% }); %>
                    <% } else { %>
                        <option value="">No hay tipos de vehículo disponibles</option>
                    <% } %>
                </select>
            </div>
            <div>
                <label for="nombre_propietario">Nombre del Propietario:</label><br/>
                <input class="margen_1" type="text" id="nombre_propietario" name="nombre_propietario" required>
            </div>
            <div>
                <label for="espacio_id">Espacio de Estacionamiento:</label><br/>
                <select class="margen_1"id="espacio_id" name="espacio_id" required>
                    <option value="">Seleccionar</option>
                    <% if (typeof espaciosDisponibles !== 'undefined' && espaciosDisponibles.length > 0) { %>
                        <% espaciosDisponibles.forEach(function(espacio) { %>
                            <option value="<%= espacio.espacio_id %>"><%= espacio.numero_espacio %></option>
                        <% }); %>
                    <% } else { %>
                        <option value="">No hay espacios disponibles</option>
                    <% } %>
                </select>
            </div>
            <button class="margen_1" type="submit">Registrar Entrada</button>
        </form>
    </section>

    <!-- Formulario para registrar la salida de un vehículo -->
    <section>
        <h2>Registrar Salida de Vehículo</h2>
        <form action="/salida" method="POST">
            <div>
                <label for="matricula_salida">Matrícula:</label><br/>
                <input class="margen_1" type="text" id="matricula_salida" name="matricula" required>
            </div>
            <button class="margen_1" type="submit">Registrar Salida</button>
        </form>
    </section>

    <!-- Visualización de la disponibilidad de espacios -->
    <section>
        <h2>Disponibilidad de Espacios</h2>
        <table border="1">
            <thead>
                <tr>
                    <th>Número de Espacio</th>
                    <th>Estado</th>
                </tr>
            </thead>
            <tbody>
                <% if (typeof espaciosEstacionamiento !== 'undefined' && espaciosEstacionamiento.length > 0) { %>
                    <% espaciosEstacionamiento.forEach(function(espacio) { %>
                        <tr>
                            <td><%= espacio.numero_espacio %></td>
                            <td><%= espacio.estado %></td>
                        </tr>
                    <% }); %>
                <% } else { %>
                    <tr>
                        <td colspan="2">No hay espacios de estacionamiento disponibles</td>
                    </tr>
                <% } %>
            </tbody>
        </table>
    </section>

    <!-- Historial de movimientos de un vehículo -->
    <section>
        <h2>Historial de Movimientos</h2>
        <form action="/historial" method="GET">
            <div>
                <label for="matricula_historial">Matrícula:</label>
                <input type="text" id="matricula_historial" name="matricula" required><br/>
            </div>
            <button class="margen_1" type="submit">Ver Historial</button>
        </form>

        <% if (typeof historialMovimientos !== 'undefined' && historialMovimientos.length > 0) { %>
            <h3>Movimientos para la matrícula: <%= historialMatricula %></h3>
            <table border="1">
                <thead>
                    <tr>
                        <th>Entrada</th>
                        <th>Salida</th>
                        <th>Espacio</th>
                        <th>Costo</th>
                    </tr>
                </thead>
                <tbody>
                    <% historialMovimientos.forEach(function(movimiento) { %>
                        <tr>
                            <td><%= movimiento.entrada %></td>
                            <td><%= movimiento.salida || 'En estacionamiento' %></td>
                            <td><%= movimiento.numero_espacio %></td>
                            <td><%= movimiento.costo ? '$' + movimiento.costo : '-' %></td>
                        </tr>
                    <% }); %>
                </tbody>
            </table>
        <% } else if (typeof historialMovimientos !== 'undefined') { %>
            <p>No se encontraron movimientos para la matrícula ingresada.</p>
        <% } %>
    </section>

</div>

    <footer>
        <p>Gestión de Estacionamiento</p>
        <p>© Parking Plus</p>
    </footer>
</body>
</html>
